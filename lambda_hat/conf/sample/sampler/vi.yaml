# @package _global_.sampler
name: vi
vi:
  # Variational family
  M: 8              # number of mixture components
  r: 2              # rank budget per component

  # Optimization
  steps: 5000       # optimization steps
  batch_size: 256   # minibatch size
  lr: 0.01          # learning rate
  eval_every: 50    # how often to record metrics

  # Posterior
  gamma: 0.001      # localizer strength (tune in {1e-4, 1e-3, 1e-2})

  # Evaluation
  eval_samples: 64  # MC samples for final estimate

  # Precision
  dtype: float32
  use_whitening: true  # deprecated, use whitening_mode

  # Whitening (Stage 1)
  whitening_mode: none      # "none"|"rmsprop"|"adam" - geometry whitening
  whitening_decay: 0.99     # EMA decay for gradient moments

  # Stability (Stage 1)
  clip_global_norm: 5.0     # gradient clipping threshold (null to disable)
  alpha_temperature: 1.0    # softmax temperature on mixture weights

  # Diagnostics (Stage 2)
  tensorboard: false        # enable TensorBoard logging (requires tensorboardX)
