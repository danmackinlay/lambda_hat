store_root: "runs"
jax_enable_x64: true

targets:
  - { model: small, data: small, teacher: _null, seed: 42 }
  - { model: base,  data: base,  teacher: _null, seed: 43,
      overrides: { training: { steps: 10000 } } }

samplers:
  - { name: hmc }
  - { name: mclmc }
  - { name: sgld, overrides: { step_size: 1e-6, eval_every: 50 }, seed: 12345 }
  # VI sampler: mixture of factor analyzers with STL + RB gradients
  - { name: vi, overrides: { algo: mfa, M: 8, r: 2, gamma: 0.001 }, seed: 54321 }
  # VI sampler: normalizing flow-based VI (requires --extra flowvi) - CURRENTLY BROKEN
  # NOTE: FlowJAX 17.2.1 API incompatibility - jitted functions cannot pass through jax.lax.scan
  # - { name: vi, overrides: { algo: flow, M: 8, r: 2, gamma: 0.001 }, seed: 54322 }